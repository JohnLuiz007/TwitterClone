<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TwitterClone</title>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" 
    crossorigin="anonymous" referrerpolicy="no-referrer" />

    <link rel="stylesheet" href="pageStyle.css">
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const loginContainer = document.getElementById('loginContainer');
            const signupContainer = document.getElementById('signupContainer');
            const showSignupBtn = document.getElementById('showSignupBtn');
            const showLoginBtn = document.getElementById('showLoginBtn');

            showSignupBtn.addEventListener('click', function () {
                loginContainer.style.display = 'none';
                signupContainer.style.display = 'block';
            });

            showLoginBtn.addEventListener('click', function () {
                loginContainer.style.display = 'block';
                signupContainer.style.display = 'none';
            });

            const loginForm = document.getElementById('loginForm');
            const signupForm = document.getElementById('signupForm');
            const loginError = document.getElementById('loginError');

            loginForm.addEventListener('submit', async (event) => {
                event.preventDefault();

                try {
                    const username = document.getElementById('username').value;
                    const password = document.getElementById('password').value;

                    // Validate input
                    if (!username || !password) {
                        loginError.innerText = "Username and password are required.";
                        loginError.style.display = 'block';
                        return;
                    }

                    const res = await fetch("/api/v1/auth/login", {
                        method: "POST",
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ username, password })
                    });

                    const checker = await res.text();
                    console.log(checker);

                    if (res.ok) {
                        // Redirect to try.html after successful login
                        window.location.href = "try.html";
                    } else {
                        // Display error message for incorrect credentials
                        loginError.innerText = "Incorrect username or password. Please try again.";
                        loginError.style.display = 'block';
                    }

                } catch (error) {
                    console.error("Error cause: ", error.message);
                }
            });

            signupForm.addEventListener('submit', async (event) => {
                event.preventDefault();

                const newUser = document.getElementById("newUsername").value;
                const newPass = document.getElementById("newPassword").value;
                const retyped = document.getElementById("retypePassword").value;

                if (newPass != retyped) {
                    console.log("Retype the password correctly.");
                    return;
                }

                try {
                    const sec = await fetch("/api/v1/auth/register", {
                        method: "POST",
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ username: newUser, password: retyped })
                    });

                    // Rest of your code for handling the response

                } catch (error) {
                    console.error("Error during registration:", error.message);
                }
            });
        })

        document.addEventListener('DOMContentLoaded', function () {
            const borderDivider = document.querySelector('.border-divider');

            // Set initial width to 0%
            borderDivider.style.width = '0%';

            // Animate the width of the border-divider to 60% after a delay
            setTimeout(() => {
                borderDivider.style.width = '60%';
            }, 100); // Adjust the delay as needed
        });

        // Sirs Code

        async function helloWorld() {
            const res = await fetch("/api")
            const text = await res.text()
            console.log(text);
        }

        async function register() {
            const res = await fetch("/api/v1/auth/register", {
                method: "POST",
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    username: "joblipat",
                    password: "password"
                })
            })
            return await res.text()
        }

        async function login() {
            const res = await fetch("/api/v1/auth/login", {
                method: "POST",
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    username: "joblipat",
                    password: "password"
                })
            })
            const token = await res.text()
            console.log(token);

        }

        async function start() {
            await helloWorld()
            await register()
            await login()
        }

        start()
    </script>


</head>
<body>

<!-- Start Sidebar -->
<div class="sidebar">
<<<<<<< HEAD

=======
>>>>>>> da751ab336422bb025cdae7901a1f108360e2a1f
    <a href="try.html" class="sidebarOption active">
        <span class="material-symbols-outlined">home</span>
        <h2>Home</h2>
    </a>
    <a href="#" class="sidebarOption">
        <span class="material-symbols-outlined">search</span>
        <h2>Explore</h2>
    </a>
    <a href="#" class="sidebarOption">
        <span class="material-symbols-outlined">notifications_none</span>
        <h2>Notifications</h2>
    </a>
    <a href="profile.html" class="sidebarOption">
        <span class="material-symbols-outlined">perm_identity</span>
        <h2>Profile</h2>
    </a>

    <footer>
        <p>Terms of Service</p>
        <p>Privacy Policy</p>
        <p>Cookie Policy</p>
        <p>Â© 2024 Mapua Gang, Inc.</p>
    </footer>
</div>
<!-- End Sidebar -->

<!-- Start Feed -->
<div class="feed">
    <div class="feed__header">
        <!-- Feed header content -->
    </div>
    <div class="tweetBoxContainer">
        <!-- Start Tweetbox -->
        <div class="tweetBox">
            <form id="tweetForm">
                <div class="shorter-border">
                    <div class="tweetbox__input">
                        <input type="text" id="tweetContent" placeholder="What's on your mind?" />
                    </div>
                </div>
                <button type="button" onclick="postTweet()" class="tweetBox__tweetButton">Post</button>
            </form>
        </div>
    </div>
   
        <div id="container">
            <!-- The posts will be dynamically added here -->
        </div>
    </div>
    </div>
</div>

<div class="widgets">
   
</div>


<script src="jwt.js"></script>
</body>
</html>
